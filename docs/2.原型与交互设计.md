​🌌 Nebula KTV - Phase 2: 原型与交互设计文档
项目信息 内容
阶段 Phase 2 (Prototype & Interaction Design)
版本 v1.0 (Low-Fidelity)
适用端 极氪 001 车机 (8155 芯片) / 横屏网页
核心原则 车载优先 (Car-First)：极大触控区、极简层级、防误触。
1. 设计概述 (Design Overview)
​本阶段的目标是确定页面的结构布局（Layout）和核心交互逻辑（Interaction Logic），暂时忽略配色和具体 UI 样式。
​1.1 核心页面架构
​系统仅包含两个核心视图：
​首页资源库 (Library Home): 负责“找歌”。采用“大搜索 + 直观列表”布局。
​沉浸播放台 (Player Stage): 负责“唱歌”。包含“沉浸模式”和“交互模式”两种状态。
​2. 页面原型与布局 (Wireframes)
​2.1 首页 / 资源库 (Home Library)
​核心目标： 快速定位目标歌曲，一键播放。
​布局逻辑： 上中下三层结构，搜索权重最高。
元素详解
​Top Bar (顶部栏):
​全局搜索框: 占据整行宽度，高度 >60px。支持输入歌手或歌名。
​Recent Section (最近添加):
​横向滚动容器: 展示最近入库的歌曲封面。
​卡片尺寸: 正方形大封面，适合快速点播。
​List Section (全部歌曲):
​列表项高度: 必须 >100px (方便盲操)。
​内容结构: 左侧封面 | 中间歌名(大)+歌手(中)+元数据标签(小,如BPM) | 右侧巨大的播放按钮。
​2.2 播放页 - 沉浸模式 (Immersive Mode)
​触发条件： 用户无操作 5 秒后自动进入。
​核心目标： 零干扰，纯粹 K 歌体验。
元素详解
​背景: 全屏 MV 视频画面（无遮挡）。
​歌词区域:
​位置：屏幕中下方 (约 Bottom 20%)。
​当前句: 字号极大 (60px+)，高亮显示。
​下一句: 字号较小，半透明/灰色。
​2.3 播放页 - 交互模式 (Interactive Mode)
​触发条件： 点击屏幕任意位置唤起。
​核心目标： 提供 P0 级核心控制功能 (原唱切换、切歌)。
元素详解
​Top Overlay (顶部遮罩):
​< 返回 按钮：点击退出播放，返回首页。
​歌曲标题显示。
​Bottom Overlay (底部控制栏):
​高度: 至少占屏幕高度 25%。
​进度条: 粗线条，滑块 (Thumb) 尺寸加大。
​核心控件:
​左侧: [原唱/伴奏] 切换开关 (Toggle Switch 形态)。
​中间: [播放/暂停] (尺寸最大，视觉中心)。
​右侧: [下一首]。
​3. 核心交互逻辑确认 (Interaction Logic)
​为确保代码逻辑的健壮性，以下“异常”与“临界”场景的处理逻辑已固化。
​3.1 🚦 资源状态处理 (Resource State)
​场景: 文件已入库，但 AI (UVR5/Whisper) 尚未处理完成。
​表现:
​首页列表中的歌曲卡片置灰 (Dimmed)。
​显示 🔄 Processing 标签。
​点击时弹出 Toast 提示：“AI 正在加工中，请稍候...”。
​3.2 🛡️ 播放降级策略 (Fallback Strategy)
​场景: 播放时发现 inst.mp3 (伴奏) 加载失败或损坏。
​表现:
​系统自动降级，仅加载 original.mp3。
​界面左下角的 [原唱/伴奏] 开关自动切至 “原唱”。
​开关状态变为 Disabled (不可点/灰色)。
​顶部提示：“伴奏加载失败，仅提供原唱模式”。
​3.3 🖐️ 触控反馈与显隐 (Feedback & Timeout)
​视觉反馈: 所有按钮按下时 (Active)，必须有明显的 变色 或 缩放 (Scale down) 效果，弥补车机无震动反馈的缺陷。
​自动隐藏: 交互模式遮罩层显示时间为 5 秒。
​特殊规则: 若用户手指按住进度条（正在拖拽），倒计时暂停；松手后重置计时。
​3.4 ⏳ 同步缓冲机制 (Sync & Buffering)
​机制: 浏览器需同时加载 Video + Audio(Original) + Audio(Inst)。
​规则: 必须 三轨全部 Ready 才能开始播放。
​表现: 若任意轨道缓冲中，强制显示 Loading 动画，画面暂停。严禁出现“声音响了画面还在卡”的异步现象。
​3.5 🎚️ 音频切换逻辑 (Source Crossfade)
​动作: 用户点击 [原唱/伴奏] 开关。
​逻辑: 使用 Web Audio API 进行 500ms 交叉渐变 (Crossfade)。
​Inst_Gain 从 1.0 -> 0.0
​Original_Gain 从 0.0 -> 1.0
​目的: 消除爆音，保证原唱音质无损。
​文档生成时间: 2025-12-22